{"code":"!function(e){var t={};function n(a){if(t[a])return t[a].exports;var r=t[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var r in e)n.d(a,r,function(t){return e[t]}.bind(null,r));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,\"a\",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p=\"\",n(n.s=157)}({1:function(e,t,n){\"use strict\";n.d(t,\"k\",(function(){return a})),n.d(t,\"i\",(function(){return r})),n.d(t,\"a\",(function(){return s})),n.d(t,\"b\",(function(){return o})),n.d(t,\"g\",(function(){return i})),n.d(t,\"h\",(function(){return l})),n.d(t,\"f\",(function(){return d})),n.d(t,\"c\",(function(){return f})),n.d(t,\"e\",(function(){return h})),n.d(t,\"d\",(function(){return m})),n.d(t,\"j\",(function(){return g}));const a=(e,t)=>{new Promise(n=>setTimeout((function(){t()}),e))};function r(e,t){socket.emit(e,t)}async function s(e){return await new Promise(t=>setTimeout(t,e))}function o(e,t){var n=$(e),r=t/1e3,s=setInterval((function(){r-=1,n.html(r+\" sec\")}),1e3);a(t,(function(){n.fadeOut(500),clearInterval(s)}))}function i(e){var t=$(\".scale-info h3\"),n=$(\".scale-info p\");e=JSON.parse(e),t.html(e.weight+\"g\"),n.html(e.barcode)}function l(e,t){var n=$(\".scale-info h3\"),a=$(\".scale-info p\");\"string\"==typeof e&&(e=JSON.parse(e)),n.html(e.weight+\"g\"),a.html(e.barcode),null==e.wms&&(e.wms=0),$(\".table-wrapper .text-center\").length&&$(\".table-wrapper .text-center\").remove();var r=$(\".table-wrapper table tbody\"),s=new Date;s=s.toLocaleString(\"en-US\",{timeZone:\"Europe/Bucharest\",timeStyle:\"medium\",dateStyle:\"long\"});var o=$(\".table-wrapper table tbody tr:first-child th\").html();if(null==o&&(o=0),o=parseInt(o)+1,e.wms)var i=\"last-row-animation-good\";else i=\"last-row-animation-good\";r.prepend('<tr class=\"'+i+'\" timestamp=\"'+s+'\" barcode=\"'+e.barcode+'\">\\n                          <th scope=\"row\">'+o+\"</th>\\n                          <td>\"+e.wms+\"</td>\\n                          <td>\"+e.barcode+\"</td>\\n                          <td>\"+e.weight+\"g</td>\\n                          <td>\"+s.split(\", \")[0]+\", \"+s.split(\", \")[1]+\"</td>\\n                      </tr>\"),f(t)}var c=!0;function d(e){var t=$(\".gate-info\"),n=$(\".gate-info h3\");0==e?(t.attr(\"status\",\"closed\"),n.html(\"Closed\"),u()||(h(\"on\"),p())):1==e?(t.attr(\"status\",\"open\"),n.html(\"Open\"),u()||(h(\"on\"),p())):a(2e3,(function(){})),a(1e3,(function(){\"Unknown\"==n.text()&&(u()&&(h(\"off\"),p()),c&&(c=!1))}))}function u(){return $(\"#switch-conveyor\")[0].checked}function p(){var e=$(\"#switch-conveyor\");e[0].checked=!e[0].checked}function f(e,t,n){var a,r,s,o;for(a=document.getElementById(e).value.toUpperCase(),r=document.getElementById(t).getElementsByTagName(\"tr\"),o=0;o<r.length;o++)(s=r[o].getElementsByTagName(\"td\")[n])&&((s.textContent||s.innerText).toUpperCase().indexOf(a)>-1?r[o].style.display=\"\":r[o].style.display=\"none\")}let h=async e=>{$.ajax({url:\"/api/conveyor?setStatus=\"+e,type:\"GET\"})},m=async e=>(await fetch(\"/api/conveyor\")).json();function g(e,t=0){0==t?$(\"notification\").append('<div class=\"messages hideMe\">\\n                                    <div class=\"alert alert-info mt-3 mb-0\" role=\"alert\">\\n                                    <i class=\"fas fa-barcode\"></i>\\n                                        <background></background>\\n                                        '+e+\"\\n                                    </div>\\n                                </div>\").show(\"slow\"):1==t?$(\"notification\").append('<div class=\"messages hideMe\">\\n                                    <div class=\"alert alert-danger mt-3 mb-0\" role=\"alert\">\\n                                        <i class=\"fas fa-exclamation-triangle\"></i>\\n                                        <background></background>\\n                                        '+e+\"\\n                                    </div>\\n                                </div>\").show(\"slow\"):2==t?$(\"notification\").append('<div class=\"messages hideMe\">\\n                                        <div class=\"alert alert-success mt-3 mb-0\" role=\"alert\">\\n                                            <i class=\"fas fa-print\"></i>\\n                                            <background></background>\\n                                            '+e+\"\\n                                        </div>\\n                                </div>\").show(\"slow\"):3==t?$(\"notification\").append('<div class=\"messages hideMe\">\\n                                        <div class=\"alert alert-info mt-3 mb-0\" role=\"alert\">\\n                                            <i class=\"fas fa-times-circle\"></i>\\n                                            <background></background>\\n                                            '+e+\"\\n                                        </div>\\n                                </div>\").show(\"slow\"):4==t&&$(\"notification\").append('<div class=\"messages hideMe\">\\n                                        <div class=\"alert alert-success mt-3 mb-0\" role=\"alert\">\\n                                            <i class=\"fas fa-info-circle\"></i>\\n                                            <background></background>\\n                                            '+e+\"\\n                                        </div>\\n                                </div>\").show(\"slow\")}},157:function(e,t,n){n(158);n(160),n(161),n(162),$(\".scale-page\").length&&(console.log(\"scale.js added\"),n(163)),$(\".conveyor-page\").length&&(console.log(\"conveyor.js added\"),n(164)),$(\".scanner-page\").length&&(console.log(\"scanner.js added\"),n(165)),$(\".team-page\").length&&(console.log(\"team.js added\"),n(166)),$(\".dashboard-page\").length&&(console.log(\"dashboard.js added\"),n(167)),$(\"#zones-list\").length&&(console.log(\"map.js added\"),n(168))},158:function(e,t,n){(function(e){function n(e,t){for(var n=0,a=e.length-1;a>=0;a--){var r=e[a];\".\"===r?e.splice(a,1):\"..\"===r?(e.splice(a,1),n++):n&&(e.splice(a,1),n--)}if(t)for(;n--;n)e.unshift(\"..\");return e}function a(e,t){if(e.filter)return e.filter(t);for(var n=[],a=0;a<e.length;a++)t(e[a],a,e)&&n.push(e[a]);return n}t.resolve=function(){for(var t=\"\",r=!1,s=arguments.length-1;s>=-1&&!r;s--){var o=s>=0?arguments[s]:e.cwd();if(\"string\"!=typeof o)throw new TypeError(\"Arguments to path.resolve must be strings\");o&&(t=o+\"/\"+t,r=\"/\"===o.charAt(0))}return(r?\"/\":\"\")+(t=n(a(t.split(\"/\"),(function(e){return!!e})),!r).join(\"/\"))||\".\"},t.normalize=function(e){var s=t.isAbsolute(e),o=\"/\"===r(e,-1);return(e=n(a(e.split(\"/\"),(function(e){return!!e})),!s).join(\"/\"))||s||(e=\".\"),e&&o&&(e+=\"/\"),(s?\"/\":\"\")+e},t.isAbsolute=function(e){return\"/\"===e.charAt(0)},t.join=function(){var e=Array.prototype.slice.call(arguments,0);return t.normalize(a(e,(function(e,t){if(\"string\"!=typeof e)throw new TypeError(\"Arguments to path.join must be strings\");return e})).join(\"/\"))},t.relative=function(e,n){function a(e){for(var t=0;t<e.length&&\"\"===e[t];t++);for(var n=e.length-1;n>=0&&\"\"===e[n];n--);return t>n?[]:e.slice(t,n-t+1)}e=t.resolve(e).substr(1),n=t.resolve(n).substr(1);for(var r=a(e.split(\"/\")),s=a(n.split(\"/\")),o=Math.min(r.length,s.length),i=o,l=0;l<o;l++)if(r[l]!==s[l]){i=l;break}var c=[];for(l=i;l<r.length;l++)c.push(\"..\");return(c=c.concat(s.slice(i))).join(\"/\")},t.sep=\"/\",t.delimiter=\":\",t.dirname=function(e){if(\"string\"!=typeof e&&(e+=\"\"),0===e.length)return\".\";for(var t=e.charCodeAt(0),n=47===t,a=-1,r=!0,s=e.length-1;s>=1;--s)if(47===(t=e.charCodeAt(s))){if(!r){a=s;break}}else r=!1;return-1===a?n?\"/\":\".\":n&&1===a?\"/\":e.slice(0,a)},t.basename=function(e,t){var n=function(e){\"string\"!=typeof e&&(e+=\"\");var t,n=0,a=-1,r=!0;for(t=e.length-1;t>=0;--t)if(47===e.charCodeAt(t)){if(!r){n=t+1;break}}else-1===a&&(r=!1,a=t+1);return-1===a?\"\":e.slice(n,a)}(e);return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},t.extname=function(e){\"string\"!=typeof e&&(e+=\"\");for(var t=-1,n=0,a=-1,r=!0,s=0,o=e.length-1;o>=0;--o){var i=e.charCodeAt(o);if(47!==i)-1===a&&(r=!1,a=o+1),46===i?-1===t?t=o:1!==s&&(s=1):-1!==t&&(s=-1);else if(!r){n=o+1;break}}return-1===t||-1===a||0===s||1===s&&t===a-1&&t===n+1?\"\":e.slice(t,a)};var r=\"b\"===\"ab\".substr(-1)?function(e,t,n){return e.substr(t,n)}:function(e,t,n){return t<0&&(t=e.length+t),e.substr(t,n)}}).call(this,n(159))},159:function(e,t){var n,a,r=e.exports={};function s(){throw new Error(\"setTimeout has not been defined\")}function o(){throw new Error(\"clearTimeout has not been defined\")}function i(e){if(n===setTimeout)return setTimeout(e,0);if((n===s||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n=\"function\"==typeof setTimeout?setTimeout:s}catch(e){n=s}try{a=\"function\"==typeof clearTimeout?clearTimeout:o}catch(e){a=o}}();var l,c=[],d=!1,u=-1;function p(){d&&l&&(d=!1,l.length?c=l.concat(c):u=-1,c.length&&f())}function f(){if(!d){var e=i(p);d=!0;for(var t=c.length;t;){for(l=c,c=[];++u<t;)l&&l[u].run();u=-1,t=c.length}l=null,d=!1,function(e){if(a===clearTimeout)return clearTimeout(e);if((a===o||!a)&&clearTimeout)return a=clearTimeout,clearTimeout(e);try{a(e)}catch(t){try{return a.call(null,e)}catch(t){return a.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function m(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new h(e,t)),1!==c.length||d||i(f)},h.prototype.run=function(){this.fun.apply(null,this.array)},r.title=\"browser\",r.browser=!0,r.env={},r.argv=[],r.version=\"\",r.versions={},r.on=m,r.addListener=m,r.once=m,r.off=m,r.removeListener=m,r.removeAllListeners=m,r.emit=m,r.prependListener=m,r.prependOnceListener=m,r.listeners=function(e){return[]},r.binding=function(e){throw new Error(\"process.binding is not supported\")},r.cwd=function(){return\"/\"},r.chdir=function(e){throw new Error(\"process.chdir is not supported\")},r.umask=function(){return 0}},160:function(e,t,n){var a,r,s,o,i,l,c;r=\"undefined\"==typeof window?this:window,o=(s=r).document,i=Array.prototype.slice,l=s.requestAnimationFrame||s.mozRequestAnimationFrame||s.webkitRequestAnimationFrame||s.msRequestAnimationFrame||function(e){return setTimeout(e,1e3/60)},c=function(){var e=50,t=50,n={dialRadius:40,dialStartAngle:135,dialEndAngle:45,value:0,max:100,min:0,valueDialClass:\"value\",valueClass:\"value-text\",dialClass:\"dial\",gaugeClass:\"gauge\",showValue:!0,gaugeColor:null,label:function(e){return Math.round(e)}};function a(e,t,n){var a=o.createElementNS(\"http://www.w3.org/2000/svg\",e);for(var r in t)a.setAttribute(r,t[r]);return n&&n.forEach((function(e){a.appendChild(e)})),a}function r(e,t){return e*t/100}function s(e,t,n){var a=Number(e);return n<a?n:a<t?t:a}function c(e,t,n,a){var r=a*Math.PI/180;return{x:Math.round(1e3*(e+n*Math.cos(r)))/1e3,y:Math.round(1e3*(t+n*Math.sin(r)))/1e3}}return function(o,d){d=function(){var e=arguments[0];return i.call(arguments,1).forEach((function(t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})),e}({},n,d);var u,p,f,h=o,m=d.max,g=d.min,v=s(d.value,g,m),y=d.dialRadius,b=d.showValue,w=d.dialStartAngle,$=d.dialEndAngle,k=d.valueDialClass,x=d.valueClass,C=(d.valueLabelClass,d.dialClass),A=d.gaugeClass,j=d.color,T=d.label,L=d.viewBox;if(w<$){console.log(\"WARN! startAngle < endAngle, Swapping\");var O=w;w=$,$=O}function S(n,a,r,s){var o=function(n,a,r){var s=e,o=t;return{end:c(s,o,n,r),start:c(s,o,n,a)}}(n,a,r),i=o.start,l=o.end,d=void 0===s?1:s;return[\"M\",i.x,i.y,\"A\",n,n,0,d,1,l.x,l.y].join(\" \")}function E(e,t){var n=r(function(e,t,n){return 100*(e-t)/(n-t)}(e,g,m),360-Math.abs(w-$)),a=n<=180?0:1;b&&(u.textContent=T.call(d,e)),p.setAttribute(\"d\",S(y,w,n+w,a))}function I(e,t){var n=j.call(d,e),a=\"stroke \"+1e3*t+\"ms ease\";p.style.stroke=n,p.style[\"-webkit-transition\"]=a,p.style[\"-moz-transition\"]=a,p.style.transition=a}return f={setMaxValue:function(e){m=e},setValue:function(e){v=s(e,g,m),j&&I(v,0),E(v)},setValueAnimated:function(e,t){var n=v;n!==(v=s(e,g,m))&&(j&&I(v,t),function(e){var t=1,n=60*e.duration,a=e.start||0,r=e.end-a,s=e.step,o=e.easing||function(e){return(e/=.5)<1?.5*Math.pow(e,3):.5*(Math.pow(e-2,3)+2)};l((function e(){var i=t/n,c=r*o(i)+a;s(c,t),t+=1,i<1&&l(e)}))}({start:n||0,end:v,duration:t||1,step:function(e,t){E(e)}}))},getValue:function(){return v}},function(e){u=a(\"text\",{x:50,y:50,fill:\"#999\",class:x,\"font-size\":\"100%\",\"font-family\":\"sans-serif\",\"font-weight\":\"normal\",\"text-anchor\":\"middle\",\"alignment-baseline\":\"middle\",\"dominant-baseline\":\"central\"}),p=a(\"path\",{class:k,fill:\"none\",stroke:\"#666\",\"stroke-width\":2.5,d:S(y,w,w)});var t=r(100,360-Math.abs(w-$)),n=a(\"svg\",{viewBox:L||\"0 0 100 100\",class:A},[a(\"path\",{class:C,fill:\"none\",stroke:\"#eee\",\"stroke-width\":2,d:S(y,w,$,t<=180?0:1)}),a(\"g\",{class:\"text-container\"},[u]),p]);e.appendChild(n)}(h),f.setValue(v),f}}(),void 0===(a=function(){return c}.call(t,n,t,e))||(e.exports=a)},161:function(e,t){console.log(\"script.js added\");var n=document.querySelector('.login-container .charInput[name=\"password\"]'),a=document.querySelectorAll('.login-container .charInput[name=\"password\"]'),r=document.querySelector('.login-container input[name=\"register\"]'),s=document.querySelector(\".login-container .passwordRules\"),o=document.querySelector(\".login-container .passwordRules li:first-child\"),i=document.querySelector(\".login-container .passwordRules li:nth-child(2)\"),l=document.querySelector(\".login-container .passwordRules li:nth-child(3)\"),c=document.querySelector(\".login-container .passwordRules li:nth-child(4)\");s&&s.classList.add(\"hideRules\"),n&&n.addEventListener(\"click\",(function(e){e.preventDefault(),console.log(\"password input clicked\"),console.log(s.classList),s.classList.remove(\"hideRules\"),console.log(s.classList)})),n&&n.addEventListener(\"input\",(function(e){var t;e.preventDefault(),passwordCheck={lowercase:!1,uppercase:!1,digit:!1,_8char:!1},t=this.value,/[a-z]/.test(t)?passwordCheck.lowercase=!0:passwordCheck.lowercase=!1,/[A-Z]/.test(t)?passwordCheck.uppercase=!0:passwordCheck.uppercase=!1,/[0-9]/.test(t)?passwordCheck.digit=!0:passwordCheck.digit=!1,t.length>=8?passwordCheck._8char=!0:passwordCheck._8char=!1,passwordCheck.lowercase?i.style.color=\"green\":i.style.color=\"red\",passwordCheck.uppercase?o.style.color=\"green\":o.style.color=\"red\",passwordCheck.digit?l.style.color=\"green\":l.style.color=\"red\",passwordCheck._8char?c.style.color=\"green\":c.style.color=\"red\",!function(e){for(var t in e)if(!e[t])return!1;return!0}(passwordCheck)?(r.value=\"Try a stronger password\",r.disabled=!0):(r.value=\"Register\",r.disabled=!1),s.classList.remove(\"hideRules\")}));for(let e=0;e<a.length;e++)a[e].addEventListener(\"click\",(function(e){e.preventDefault(),s.classList.add(\"hideRules\")})),a[e].addEventListener(\"input\",(function(e){e.preventDefault(),s.classList.add(\"hideRules\")}));var d,u;document.querySelectorAll(\".users-table tbody > tr .edit-btn\"),document.querySelector(\".edit-user\");$(document).ready((function(){document.addEventListener(\"click\",(function(e){if(e.path||e.composedPath&&e.composedPath())var t=function(e){var t=e.composedPath&&e.composedPath()||e.path,n=e.target;return null!=t?t.indexOf(window)<0?t.concat(window):t:n===window?[window]:[n].concat(function e(t,n){n=n||[];var a=t.parentNode;return a?e(a,n.concat(a)):n}(n),window)}(e)[0].parentNode;t.classList.contains(\"popup\")&&($(\".show\").removeClass(\"show\"),t.classList.toggle(\"show\")),e.target.closest(\".popup\")||$(\".show\").removeClass(\"show\")}),!1)}));try{var p=document.querySelectorAll(\".toggleSidenav\"),f=document.querySelector(\".open-button\"),h=document.querySelector(\".main-overlay\"),m=(document.querySelectorAll(\".sidenav-wrapper a\"),document.getElementById(\"mySidenav\")),g=document.getElementById(\"main\"),v=document.getElementById(\"main\"),y=document.getElementById(\"mySidenav\");function b(){setTimeout((function(){m.classList.add(\"sidenav-opened-final\"),m.classList.remove(\"sidenav-closed-final\")}),150)}function w(){m.classList.remove(\"sidenav-opened-final\"),m.classList.add(\"sidenav-closed-final\")}$(window).on(\"load\",(function(){let e=function(){$(\"body\").addClass(\"window-loaded\")};if(m)if(window.innerWidth>991){if(!m.classList.contains(\"sidenav-opened\")){(function(e){f.click(),setTimeout((function(){e()}),150)})(e)}}else w.bind()(),e()})),$(window).resize((function(){window.innerWidth>991?m.classList.contains(\"sidenav-opened\")||f.click():m.classList.contains(\"sidenav-opened\")&&h.click()})),f.addEventListener(\"click\",(function(){let e=new Date;e=e.getMilliseconds(),m.classList.contains(\"sidenav-opened\")||(m.classList.add(\"sidenav-opened\"),h.classList.remove(\"hidden-overlay\"),g.getBoundingClientRect().width>500&&(g.classList.add(\"pl-250\"),g.classList.remove(\"pl-50\"))),m.classList.remove(\"sidenav-closed\"),h.classList.remove(\"hidden-overlay\"),m.classList.toggle(\"click-open\");for(var t=0;t<p.length;t++)p[t].classList.toggle(\"hidden-button\");b.bind()()})),window.innerWidth<=991&&$(\"#mySidenav\").hover((function(){if(!m.classList.contains(\"click-open\")){m.classList.add(\"sidenav-opened\"),g.getBoundingClientRect().width>500&&(g.classList.add(\"pl-250\"),g.classList.remove(\"pl-50\")),h.classList.remove(\"hidden-overlay\"),m.classList.remove(\"sidenav-closed\");for(var e=0;e<p.length;e++)p[e].classList.toggle(\"hidden-button\")}b.bind()()}),(function(){if(!m.classList.contains(\"click-open\")){w(),m.classList.remove(\"sidenav-opened\"),g.getBoundingClientRect().width>500&&(g.classList.remove(\"pl-250\"),g.classList.add(\"pl-50\")),h.classList.add(\"hidden-overlay\"),m.classList.add(\"sidenav-closed\");for(var e=0;e<p.length;e++)p[e].classList.toggle(\"hidden-button\")}})),v.addEventListener(\"click\",(function(){if(window.innerWidth<=991&&m.classList.contains(\"click-open\")){w(),m.classList.remove(\"click-open\"),m.classList.remove(\"sidenav-opened\"),g.getBoundingClientRect().width>500&&(g.classList.remove(\"pl-250\"),g.classList.add(\"pl-50\")),h.classList.add(\"hidden-overlay\"),m.classList.add(\"sidenav-closed\");for(var e=0;e<p.length;e++)p[e].classList.toggle(\"hidden-button\")}})),y.addEventListener(\"click\",(function(e){e.stopPropagation()}),!1),document.querySelector(\".open-button\").addEventListener(\"click\",(function(e){e.stopPropagation()}),!1)}catch(e){console.warn(\"It looks like there is no sidebar navigation\")}setTimeout(50,$(\".messages\").animate({right:\"0px\",opacity:\"1\",visibility:\"visible\"})),d=3e3,u=function(){console.log(\"3 seconds async timeout\")},new Promise(e=>setTimeout((function(){u()}),d))},162:function(e,t,n){\"use strict\";n.r(t),n.d(t,\"Headers\",(function(){return f})),n.d(t,\"Request\",(function(){return w})),n.d(t,\"Response\",(function(){return k})),n.d(t,\"DOMException\",(function(){return C})),n.d(t,\"fetch\",(function(){return A}));var a=\"URLSearchParams\"in self,r=\"Symbol\"in self&&\"iterator\"in Symbol,s=\"FileReader\"in self&&\"Blob\"in self&&function(){try{return new Blob,!0}catch(e){return!1}}(),o=\"FormData\"in self,i=\"ArrayBuffer\"in self;if(i)var l=[\"[object Int8Array]\",\"[object Uint8Array]\",\"[object Uint8ClampedArray]\",\"[object Int16Array]\",\"[object Uint16Array]\",\"[object Int32Array]\",\"[object Uint32Array]\",\"[object Float32Array]\",\"[object Float64Array]\"],c=ArrayBuffer.isView||function(e){return e&&l.indexOf(Object.prototype.toString.call(e))>-1};function d(e){if(\"string\"!=typeof e&&(e=String(e)),/[^a-z0-9\\-#$%&'*+.^_`|~!]/i.test(e)||\"\"===e)throw new TypeError(\"Invalid character in header field name\");return e.toLowerCase()}function u(e){return\"string\"!=typeof e&&(e=String(e)),e}function p(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return r&&(t[Symbol.iterator]=function(){return t}),t}function f(e){this.map={},e instanceof f?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function h(e){if(e.bodyUsed)return Promise.reject(new TypeError(\"Already read\"));e.bodyUsed=!0}function m(e){return new Promise((function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function g(e){var t=new FileReader,n=m(t);return t.readAsArrayBuffer(e),n}function v(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function y(){return this.bodyUsed=!1,this._initBody=function(e){var t;this.bodyUsed=this.bodyUsed,this._bodyInit=e,e?\"string\"==typeof e?this._bodyText=e:s&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:o&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:a&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():i&&s&&((t=e)&&DataView.prototype.isPrototypeOf(t))?(this._bodyArrayBuffer=v(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):i&&(ArrayBuffer.prototype.isPrototypeOf(e)||c(e))?this._bodyArrayBuffer=v(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText=\"\",this.headers.get(\"content-type\")||(\"string\"==typeof e?this.headers.set(\"content-type\",\"text/plain;charset=UTF-8\"):this._bodyBlob&&this._bodyBlob.type?this.headers.set(\"content-type\",this._bodyBlob.type):a&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set(\"content-type\",\"application/x-www-form-urlencoded;charset=UTF-8\"))},s&&(this.blob=function(){var e=h(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error(\"could not read FormData body as blob\");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?h(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(g)}),this.text=function(){var e,t,n,a=h(this);if(a)return a;if(this._bodyBlob)return e=this._bodyBlob,t=new FileReader,n=m(t),t.readAsText(e),n;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),a=0;a<t.length;a++)n[a]=String.fromCharCode(t[a]);return n.join(\"\")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error(\"could not read FormData body as text\");return Promise.resolve(this._bodyText)},o&&(this.formData=function(){return this.text().then($)}),this.json=function(){return this.text().then(JSON.parse)},this}f.prototype.append=function(e,t){e=d(e),t=u(t);var n=this.map[e];this.map[e]=n?n+\", \"+t:t},f.prototype.delete=function(e){delete this.map[d(e)]},f.prototype.get=function(e){return e=d(e),this.has(e)?this.map[e]:null},f.prototype.has=function(e){return this.map.hasOwnProperty(d(e))},f.prototype.set=function(e,t){this.map[d(e)]=u(t)},f.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},f.prototype.keys=function(){var e=[];return this.forEach((function(t,n){e.push(n)})),p(e)},f.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),p(e)},f.prototype.entries=function(){var e=[];return this.forEach((function(t,n){e.push([n,t])})),p(e)},r&&(f.prototype[Symbol.iterator]=f.prototype.entries);var b=[\"DELETE\",\"GET\",\"HEAD\",\"OPTIONS\",\"POST\",\"PUT\"];function w(e,t){var n,a,r=(t=t||{}).body;if(e instanceof w){if(e.bodyUsed)throw new TypeError(\"Already read\");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new f(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,r||null==e._bodyInit||(r=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||\"same-origin\",!t.headers&&this.headers||(this.headers=new f(t.headers)),this.method=(n=t.method||this.method||\"GET\",a=n.toUpperCase(),b.indexOf(a)>-1?a:n),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,(\"GET\"===this.method||\"HEAD\"===this.method)&&r)throw new TypeError(\"Body not allowed for GET or HEAD requests\");this._initBody(r)}function $(e){var t=new FormData;return e.trim().split(\"&\").forEach((function(e){if(e){var n=e.split(\"=\"),a=n.shift().replace(/\\+/g,\" \"),r=n.join(\"=\").replace(/\\+/g,\" \");t.append(decodeURIComponent(a),decodeURIComponent(r))}})),t}function k(e,t){t||(t={}),this.type=\"default\",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText=\"statusText\"in t?t.statusText:\"\",this.headers=new f(t.headers),this.url=t.url||\"\",this._initBody(e)}w.prototype.clone=function(){return new w(this,{body:this._bodyInit})},y.call(w.prototype),y.call(k.prototype),k.prototype.clone=function(){return new k(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new f(this.headers),url:this.url})},k.error=function(){var e=new k(null,{status:0,statusText:\"\"});return e.type=\"error\",e};var x=[301,302,303,307,308];k.redirect=function(e,t){if(-1===x.indexOf(t))throw new RangeError(\"Invalid status code\");return new k(null,{status:t,headers:{location:e}})};var C=self.DOMException;try{new C}catch(e){(C=function(e,t){this.message=e,this.name=t;var n=Error(e);this.stack=n.stack}).prototype=Object.create(Error.prototype),C.prototype.constructor=C}function A(e,t){return new Promise((function(n,a){var r=new w(e,t);if(r.signal&&r.signal.aborted)return a(new C(\"Aborted\",\"AbortError\"));var o=new XMLHttpRequest;function l(){o.abort()}o.onload=function(){var e,t,a={status:o.status,statusText:o.statusText,headers:(e=o.getAllResponseHeaders()||\"\",t=new f,e.replace(/\\r?\\n[\\t ]+/g,\" \").split(/\\r?\\n/).forEach((function(e){var n=e.split(\":\"),a=n.shift().trim();if(a){var r=n.join(\":\").trim();t.append(a,r)}})),t)};a.url=\"responseURL\"in o?o.responseURL:a.headers.get(\"X-Request-URL\");var r=\"response\"in o?o.response:o.responseText;setTimeout((function(){n(new k(r,a))}),0)},o.onerror=function(){setTimeout((function(){a(new TypeError(\"Network request failed\"))}),0)},o.ontimeout=function(){setTimeout((function(){a(new TypeError(\"Network request failed\"))}),0)},o.onabort=function(){setTimeout((function(){a(new C(\"Aborted\",\"AbortError\"))}),0)},o.open(r.method,function(e){try{return\"\"===e&&self.location.href?self.location.href:e}catch(t){return e}}(r.url),!0),\"include\"===r.credentials?o.withCredentials=!0:\"omit\"===r.credentials&&(o.withCredentials=!1),\"responseType\"in o&&(s?o.responseType=\"blob\":i&&-1!==r.headers.get(\"Content-Type\").indexOf(\"application/octet-stream\")&&(o.responseType=\"arraybuffer\")),r.headers.forEach((function(e,t){o.setRequestHeader(t,e)})),r.signal&&(r.signal.addEventListener(\"abort\",l),o.onreadystatechange=function(){4===o.readyState&&r.signal.removeEventListener(\"abort\",l)}),o.send(void 0===r._bodyInit?null:r._bodyInit)}))}A.polyfill=!0,self.fetch||(self.fetch=A,self.Headers=f,self.Request=w,self.Response=k)},163:function(e,t,n){\"use strict\";n.r(t);var a=n(1);$(\"#scaleInput\").keyup((function(){Object(a.c)(\"scaleInput\",\"scaleTable\",1)})),socket.on(\"socketChannel\",e=>{e.topic.includes(username+\"/scale\")&&Object(a.h)(e.message,1)});(async()=>await(async()=>(await fetch(\"/api/get-scale-recordings\")).json())())().then(e=>{if(e.length){var t=$(\".table-wrapper table tbody\");for(var[n,a]of Object.entries(e)){var r=new Date(a.timestamp);r.setHours(r.getHours()-2),a.timestamp=r.toLocaleString(\"en-US\",{timeZone:\"Europe/Bucharest\",timeStyle:\"medium\",dateStyle:\"long\"}),t.prepend('<tr timestamp=\"'+a.timestamp+'\" barcode=\"'+a.barcode+'\">\\n                        <th scope=\"row\">'+(parseInt(n)+1)+\"</th>\\n                        <td>\"+a.wms+\"</td>\\n                        <td>\"+a.barcode+\"</td>\\n                        <td>\"+a.value+\"g</td>\\n                        <td>\"+a.timestamp.split(\", \")[0]+\", \"+a.timestamp.split(\", \")[1]+\"</td>\\n                    </tr>\")}}else $(\".table-wrapper\").append('<p class=\"text-center\">No recordings</p>')})},164:function(e,t,n){\"use strict\";n.r(t);var a,r=n(1);function s(e){new Date;$(\".small-box #switch-conveyor\").prop(\"disabled\",!0),$(\".small-box #switch-conveyor\").parent().append(\"<div class='switch-disable-time'>\"+e/1e3+\" sec</div>\"),Object(r.b)(\".switch-disable-time\",e),Object(r.k)(e,(function(){$(\".small-box #switch-conveyor\").prop(\"disabled\",!1)}))}$(\"#switch-conveyor\").click((function(){i()})),Object(r.i)(\"socketChannel\",{topic:\"gate/\"+username,message:\"status\"}),a=setInterval((function(){Object(r.i)(\"socketChannel\",{topic:\"gate/\"+username,message:\"status\"})}),2e3),window.gateChecker=a,socket.on(\"socketChannel\",e=>{e.topic.includes(username+\"/scale\")&&$(\".scale-info\").length&&Object(r.g)(e.message),e.topic.includes(\"gate/\"+username)&&Object(r.f)(e.message)}),(async()=>{let e=await Object(r.d)();parseInt(e[0].status)?$(\".small-box #switch-conveyor\").prop(\"checked\",!0):$(\".small-box #switch-conveyor\").prop(\"checked\",!1),i()})();var o=!0;async function i(){if($(\".small-box #switch-conveyor\").is(\":checked\")){if($(\"#conveyor-img\").attr(\"src\",\"images/conveyor_\"+username+\"_start.png\"),!o){Object(r.e)(\"on\"),s(1e4),$(\".send-command-button\").removeClass(\"send-stop\").addClass(\"send-start\"),Object(r.j)(\"Conveyor started\",1),a=setInterval((function(){Object(r.i)(\"socketChannel\",{topic:\"gate/\"+username,message:\"status\"})}),2e3),window.gateChecker=a,Object(r.i)(\"socketChannel\",{topic:\"start/stop\",message:\"start\"});new Date;Object(r.k)(5e3,(function(){Object(r.i)(\"socketChannel\",{topic:\"start/stop\",message:\"start\"})})),Object(r.k)(7e3,(function(){Object(r.i)(\"socketChannel\",{topic:\"start/stop\",message:\"start\"})})),Object(r.k)(1e4,(function(){Object(r.i)(\"socketChannel\",{topic:\"start/stop\",message:\"start\"})}))}o=!1}else{if($(\"#conveyor-img\").attr(\"src\",\"images/conveyor_\"+username+\"_stop.png\"),!o){Object(r.e)(\"off\"),s(5e3),$(\".send-command-button\").removeClass(\"send-start\").addClass(\"send-stop\"),clearInterval(a),Object(r.j)(\"Conveyor stopped\",4);new Date;Object(r.i)(\"socketChannel\",{topic:\"start/stop\",message:\"stop\"}),Object(r.k)(2e3,(function(){Object(r.i)(\"socketChannel\",{topic:\"start/stop\",message:\"stop\"})})),Object(r.k)(4e3,(function(){Object(r.i)(\"socketChannel\",{topic:\"start/stop\",message:\"stop\"})}))}o=!1}}function l(){(async()=>{(await(async()=>(await fetch(\"/api/get-voltage?source1&source2\")).json())()).forEach(e=>{if(e.sensorQueried.includes(\"source1\")){var t=e.value;$(\".supply-1 h3\").html(t+\"V\")}else if(e.sensorQueried.includes(\"source2\")){var n=e.value;$(\".supply-2 h3\").html(n+\"V\")}})})()}(async()=>{for(;;)l(),await Object(r.a)(5e3)})(),$(\".send-command-button\").length&&(Object(r.k)(1e3,(function(){$(\".small-box #switch-conveyor\").is(\":checked\")?$(\".send-command-button\").addClass(\"send-start\"):$(\".send-command-button\").addClass(\"send-stop\")})),$(\".send-command-button\").click((function(){$(\".small-box #switch-conveyor\").is(\":checked\")?(Object(r.i)(\"socketChannel\",{topic:\"start/stop\",message:\"start\"}),Object(r.k)(2e3,(function(){}))):(Object(r.i)(\"socketChannel\",{topic:\"start/stop\",message:\"stop\"}),Object(r.k)(2e3,(function(){})))})))},165:function(e,t,n){\"use strict\";n.r(t);var a=n(1),r=0,s=new Audio(\"/sound/scanner_sound.mp3\");Object(a.i)(\"socketChannel\",{topic:username+\"/scanner\",message:\"start\"}),socket.on(\"socketChannel\",async e=>{if(e.topic.includes(username+\"/scanner\")){e.message.barcode&&l(e.message.barcode,r);var t=\"\";if(-1==[\"start\",\"print\",\"push\",\"print_error\"].indexOf(e.message)){try{t=JSON.parse(e.message)}catch{t={barcode:\"wrong format\"}}!async function(e){$.get({url:\"/api/request-scanner-config\",success:function(t){console.log(\"SEND:\",t[0]),i(t[0].method,t[0].contenttype,t[0].url,t[0].data,e)}})}(t.barcode),Object(a.j)(\"Barcode scanned: \"+t.barcode)}}});var o=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);async function i(e,t,n,r,i){fetch(\"/proxy?url=\"+n,{method:e,body:'{\"'+r+'\": \"'+i+'\"}',headers:{\"Content-Type\":t}}).then(e=>e.text()).then(e=>{console.log(\"Received:\",JSON.parse(e));var t=JSON.parse(e).awb,n=JSON.parse(e).barcode,r=JSON.parse(e).status;if(\"ERROR\"==n)r=-1;else s.play();if(1==r){o||(Object(a.i)(\"socketChannel\",{topic:username+\"/scanner\",message:\"print\"}),function(e,t){if(o){Object(a.j)(\"On mobile you can't send print command\",2)}else{var n=window.open(e,\"_blank\");console.log(\"AWB URL:\",e),setTimeout((function(){n.close()}),300)}}(t),c(n,r)),Object(a.j)(\"AWB for barcode \"+n+\" is printing\",2),l(n,r)}else{if(o)Object(a.j)(\"Order pushed: \"+i,1);else Object(a.i)(\"socketChannel\",{topic:username+\"/scanner\",message:\"push\"}),c(n,r);Object(a.j)(\"Order pushed: \"+i,1),l(n,r)}}).catch(()=>{Object(a.j)(\"AWB printing error: \"+i,1),console.log(\"Canâ€™t access \"+n+\" response. Blocked by browser?\")})}function l(e,t){var n=$(\".table-wrapper table tbody\"),a=new Date,r=$(\".table-wrapper table tbody tr:first-child th\").html();null==r&&(r=0),r=parseInt(r)+1;var s={barcode:e,timestamp:a.toLocaleString(\"en-US\",{timeZone:\"Europe/Bucharest\",timeStyle:\"medium\",dateStyle:\"long\"})};if(t)var o=\"last-row-animation-good\";else o=\"last-row-animation-bad\";if(n.prepend('<tr class=\"'+o+'\" timestamp=\"'+s.timestamp+'\" barcode=\"'+s.barcode+'\">\\n                            <th scope=\"row\">'+r+\"</th>\\n                            <td>\"+s.barcode+\"</td>\\n                            <td>\"+t+\"</td>\\n                            <td>\"+s.timestamp.split(\", \")[0]+\" at \"+s.timestamp.split(\", \")[1]+\"</td>\\n                        </tr>\"),$(\".scanner-info h3\").html(r),1==t){var i=$(\".correct-packages h3\").html();$(\".correct-packages h3\").html(parseInt(i)+1)}if(0==t){i=$(\".wrong-packages h3\").html();$(\".wrong-packages h3\").html(parseInt(i)+1)}if(-1==t){i=$(\".error-packages h3\").html();$(\".error-packages h3\").html(parseInt(i)+1)}$(\".text-center\").length&&$(\".text-center\").remove()}let c=async(e,t)=>(await fetch(\"/api/send-scanner-recordings?barcode='\"+e+\"'&status='\"+t+\"'\")).json();$(\"#scannerInput\").keyup((function(){Object(a.c)(\"scannerInput\",\"scannerTable\",0)}));(async()=>await(async()=>(await fetch(\"/api/get-scanner-recordings\")).json())())().then(e=>{var t=$(\".table-wrapper table tbody\");if(e.length){for(var[n,a]of Object.entries(e)){var s=new Date(a.timestamp);if(s.setHours(s.getHours()-2),a.timestamp=s.toLocaleString(\"en-US\",{timeZone:\"Europe/Bucharest\",timeStyle:\"medium\",dateStyle:\"long\"}),1==a.status){var o=$(\".correct-packages h3\").html();$(\".correct-packages h3\").html(parseInt(o)+1)}if(0==a.status){o=$(\".wrong-packages h3\").html();$(\".wrong-packages h3\").html(parseInt(o)+1)}if(-1==a.status){o=$(\".error-packages h3\").html();$(\".error-packages h3\").html(parseInt(o)+1)}t.prepend('<tr timestamp=\"'+a.timestamp+'\" barcode=\"'+a.barcode+'\" status=\"'+a.status+'\">\\n                            <th scope=\"row\">'+(parseInt(n)+1)+\"</th>\\n                            <td>\"+a.barcode+\"</td>\\n                            <td>\"+a.status+\"</td>\\n                            <td>\"+a.timestamp.split(\", \")[0]+\", \"+a.timestamp.split(\", \")[1]+\"</td>\\n                        </tr>\"),r=parseInt(n)+1}$(\".scanner-info h3\").html(r)}else $(\".table-wrapper\").append('<p class=\"text-center\">No recordings</p>')})},166:function(e,t,n){\"use strict\";n.r(t);var a=n(1);let r=async e=>(await fetch(\"/api/v2/sensors-access?username=\"+e)).json();(async()=>await(async()=>{let e=await fetch(\"/api/get-users\");return console.log(e),e.json()})())().then(async e=>{console.log(e);const t=e[0].length;var n=\"\";e[0].forEach(e=>{e.Username==loggedInUser&&(n=e.company,$(\".small-box-container .company\").html(n))});for(var a=0;a<t;a++)n==e[0][a].company&&\"superadmin\"!=e[0][a].User_role&&(async()=>($(\"body\").append('\\n                <div class=\"modal modal-'+e[0][a].Username+'\" id=\"edit-user-'+e[0][a].Username+'\" aria-labelledby=\"edit-user-label-'+e[0][a].Username+'\" aria-hidden=\"true\" tabindex=\"-1\" role=\"dialog\">\\n                    <div class=\"modal-dialog fadeInModal modal-dialog-centered\" role=\"document\">\\n                        <div class=\"modal-content\">\\n    \\n                            <div class=\"modal-header\">\\n                                <h5 class=\"modal-title\" id=\\'edit-user-label-'+e[0][a].Username+\"'>Edit user: \"+e[0][a].Username+'</h5>\\n                                <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\\n                                <span aria-hidden=\"true\">&times;</span>\\n                                </button>\\n                            </div>\\n    \\n                            <div class=\"modal-body\">\\n                                <form action=\\'/api/edit-user\\' method=\\'GET\\' id=\"form-edit-user-'+e[0][a].Username+'\">\\n\\n                                    <div class=\"form-group hidden\">\\n                                        <input type=\"text\" class=\"form-control\" name=\"id\" value=\"'+e[0][a].Id+'\">\\n                                    </div>\\n    \\n                                    <div class=\"form-group\">\\n                                        <input type=\"text\" class=\"form-control\" id=\"name\" name=\"name\" value=\"'+e[0][a].Name+'\">\\n                                    </div>\\n    \\n                                    <div class=\"form-group\">\\n                                        <input type=\"text\" class=\"form-control\" id=\"username\" name=\"username\" value=\"'+e[0][a].Username+'\">\\n                                    </div>\\n    \\n                                    <div class=\"form-group\">\\n                                        <input type=\"email\" class=\"form-control\" id=\"email\" name=\"email\" value=\"'+e[0][a].Email+'\">\\n                                    </div>\\n    \\n                                    <div class=\"form-group\">\\n                                        <input type=\"text\" class=\"form-control\" id=\"password\" name=\"password\" placeholder=\\'Type a new password or leave it as it is\\'>\\n                                    </div>\\n    \\n                                    <div class=\"form-group\">\\n    \\n                                        <label>Zones</label>\\n                                    \\n                                        <div class=\"form-zones-container\">\\n                                              \\n                                        </div>         \\n    \\n                                    </div>\\n                                </form>\\n                            </div>\\n    \\n                            <div class=\"modal-footer\">\\n                                <button type=\"button\" class=\"btn btn-secondary\" data-toggle=\"modal\" data-target=\".modal-'+e[0][a].Username+'\">Close</button>\\n                                <button type=\"submit\" value=\"Submit\" form=\"form-edit-user-'+e[0][a].Username+'\" class=\"btn btn-primary\">Save Changes</button>\\n                            </div>\\n    \\n                        </div>\\n                    </div>\\n                </div>\\n                '),e[0][a].Username==loggedInUser?$(\".team-container tbody\").prepend(\"\\n                    <tr class='current-user'>\\n                        <td class=\\\"user-col\\\">\"+e[0][a].Name+\"<br>\"+e[0][a].Username+\"<br>\"+e[0][a].Email+'<br></td>\\n                        <td class=\"zones-col zones-'+e[0][a].Username+'\">\\n                            <a href=\"#\" class=\\'spinner '+e[0][a].Username+'-zone-spinner\\'>\\n                                <span>Loading...</span>\\n                            </a>\\n                        </td>\\n                        <td class=\"actions-col\">\\n                            <button disabled type=\"button\" class=\"btn btn-outline-primary edit-user-'+e[0][a].Username+'\">\\n                                <i class=\"fal fa-edit\"></i>\\n                                <span>Edit User</span>\\n                            </button>\\n                            <button disabled type=\"button\" class=\"btn btn-danger remove-user\">\\n                                <i class=\"fal fa-user-minus\"></i>\\n                                <span>Remove User</span>\\n                            </button>\\n                        </td>\\n                    </tr>\\n                '):$(\".team-container tbody\").append('\\n                        <tr>\\n                            <td class=\"user-col\">'+e[0][a].Name+\"<br>\"+e[0][a].Username+\"<br>\"+e[0][a].Email+'<br></td>\\n                            <td class=\"zones-col zones-'+e[0][a].Username+'\">\\n                                <a href=\"#\" class=\\'spinner '+e[0][a].Username+'-zone-spinner\\'>\\n                                    <span>Loading...</span>\\n                                </a>\\n                            </td>\\n                            <td class=\"actions-col\">\\n                                <button type=\"button\" class=\"btn btn-outline-primary edit-user-'+e[0][a].Username+'\">\\n                                    <i class=\"fal fa-edit\"></i>\\n                                    <span>Edit User</span>\\n                                </button>\\n                                <button type=\"button\" class=\"btn btn-danger remove-user\">\\n                                    <i class=\"fal fa-user-minus\"></i>\\n                                    <span>Remove User</span>\\n                                </button>\\n                            </td>\\n                        </tr>\\n                    '),await r(e[0][a].Username)))().then(e=>{var t=[];e.data.forEach(e=>{var n;t.push(e.zone),e.query==loggedInUser&&null!=e.zone&&$(\".modal form .form-zones-container\").append('\\n                            <div class=\"form-check\">\\n                                <input class=\"form-check-input\" type=\"checkbox\" value=\"'+e.zone+'\" id=\"'+e.zone+'\" name=\"zones\">\\n                                <label class=\"form-check-label\" for=\"'+e.zone+'\">\\n                                    '+e.zone+\"\\n                                    <span></span>\\n                                </label>\\n                            </div>\\n                        \"),n=e.query,$(\".edit-user-\"+n).click((function(){$(\"#edit-user-\"+n).modal({backdrop:\"static\"})})),$(\".team-container .\"+e.query+\"-zone-spinner\").remove(),e.error?$(\".team-container .zones-\"+e.query).append('<span class=\"no-zone\">'+e.error+\"</span>\"):$(\".team-container .zones-\"+e.query).append('<span class=\"zone\" belongsTo=\"'+e.belongsTo+'\">'+e.zone+\"</span>\")})}).then(()=>{})}).then(()=>{Object(a.k)(1e3,(function(){for(var e=0;e<$(\".team-container tr .zones-col\").length;e++)for(var t=0;t<$(\".team-container tr .zones-col\")[e].children.length;t++){var n=$(\".team-container tr .zones-col\")[e].className.split(\" \")[1].split(\"zones-\")[1],a=$(\".team-container tr .zones-col\")[e].children[t].innerHTML;\"No zone assigned\"!=a?$(\".modal-\"+n+' input[id=\"'+a+'\"]').prop(\"checked\",!0):$(\".modal-\"+n+' input[id=\"'+a+'\"]').prop(\"checked\",!1)}}))})},167:function(e,t){var n=new Date,a=new Array;a[0]=\"January\",a[1]=\"February\",a[2]=\"March\",a[3]=\"April\",a[4]=\"May\",a[5]=\"June\",a[6]=\"July\",a[7]=\"August\",a[8]=\"September\",a[9]=\"October\",a[10]=\"November\",a[11]=\"December\";a[n.getMonth()],n.getDay();let r=$(\".county-detail h3\").html();document.title=r.toUpperCase()+\" | Anysensor\";let s=\"\";function o(e,t=NaN,n=!1,a=-20,r=70){if($(\".\"+e+\"-currentValue-spinner\").remove(),isNaN(t)){var s=$(\"#\"+e+\"-gauge .currentValue\");return timeoutAsync(500,(function(){$(\"#\"+e+\"-gauge .currentValue\").html(\"<span class='no-value'>No value recorded today</span>\")})),$(\"#\"+e+\"-gauge .currentValue\").attr(\"no-value\",\"true\"),s}if((s=$(\"#\"+e+\"-gauge .currentValue\")).html(t),n){var o=Date.parse(n);o=(o=(o=new Date(o)).addHours(-2)).toLocaleString(\"en-US\",{timeZone:\"Europe/Bucharest\",timeStyle:\"medium\",dateStyle:\"long\"}),$(\"#\"+e+\"-gauge\").removeClass(\"hidden-element\"),$(\"#\"+e+\"-gauge\").parent().append(\"<p class='update-time-gauge'>Updated at \"+o+\"</p>\")}return Number.isInteger(t)?e.includes(\"source\")?$(\"#\"+e+\"-gauge g.text-container text\").append(\".0 V\"):$(\"#\"+e+\"-gauge g.text-container text\").append(\".0 &#8451;\"):e.includes(\"source\")?$(\"#\"+e+\"-gauge g.text-container text\").append(\" V\"):$(\"#\"+e+\"-gauge g.text-container text\").append(\" &#8451;\"),s}Date.prototype.addHours=function(e){return this.setTime(this.getTime()+60*e*60*1e3),this};var i=[],l=async(e,t,n,a,r=!1)=>{t.slice(),n.slice();t[0];for(var s=0,o=!1;0==o;)\"NaN\"==t[s]?s++:o=!0;t.length;var l=[],c=[];let d=await v(e);if(d[0].error||d[0].sensorAverage.forEach(e=>{e.sensorValue?l.push(e.sensorValue.toFixed(1)):l.push(null),c.push(e.sensorTime)}),l=l.reverse(),c=c.reverse(),$(\"#predictor-switch\").length,a=$(\"article.\"+e+\"-card\").attr(\"sensorType\"),$(\"article.\"+e+\"-card .no-data-from-sensor\").remove(),$(\".\"+e+\"-graph-spinner\").remove(),$(\"#\"+e+\"-graph\").remove(),$(\".\"+e+\"-card .card-body\").append('<canvas id=\"'+e+'-graph\"></canvas>'),t.length){var u=document.getElementById(e+\"-graph\").getContext(\"2d\");if(0!=r)var p={animation:!1,responsive:!0,maintainAspectRatio:!1,drawBorder:!1,legend:{labels:{fontColor:\"white\"}},scales:{xAxes:[{type:\"time\",time:{unit:r},gridLines:{color:\"rgba(0, 0, 0, 0)\"},ticks:{fontColor:\"white\"}}],yAxes:[{ticks:{beginAtZero:!1,fontColor:\"white\"},gridLines:{color:\"#415f7d\",zeroLineColor:\"#415f7d\"}}]}};else p={animation:!1,responsive:!0,maintainAspectRatio:!1,drawBorder:!1,legend:{labels:{fontColor:\"white\"}},scales:{xAxes:[{type:\"time\",time:{unit:\"minute\"},distribution:\"series\",gridLines:{color:\"rgba(0, 0, 0, 0)\"},ticks:{fontColor:\"white\"}}],yAxes:[{ticks:{beginAtZero:!1,fontColor:\"white\"},gridLines:{color:\"#415f7d\",zeroLineColor:\"#415f7d\"}}]}};var f=new Chart(u,{type:\"line\",data:{labels:n,datasets:[{label:a[0].toUpperCase()+a.slice(1,a.length),data:t,backgroundColor:\"rgba(51, 153, 255, 0.2)\",borderColor:\"rgba(51, 153, 255, 1)\",pointBorderColor:\"#343a40\",pointBackgroundColor:\"rgba(51, 153, 255, 1)\",pointHoverBackgroundColor:\"#ffc107\",pointRadius:1.5,pointHoverRadius:7,pointBorderWidth:1,borderWidth:1,lineTension:.2}]},options:p})}else{$(\".\"+e+\"-card .card-body\").append(\"<p class='no-data-from-sensor' >No data from sensor with id <b>\"+e+\"</b> for today</p>\"),$(\"#\"+e+\"-graph\").addClass(\"hidden-graph\");u=document.getElementById(e+\"-graph\").getContext(\"2d\"),f=new Chart(u,{type:\"line\",data:{labels:n,datasets:[{label:a,data:t,backgroundColor:\"#bac8db\",borderColor:\"rgba(255, 99, 132, 1)\",borderWidth:1}]},options:{animation:!1,responsive:!0,maintainAspectRatio:!1,scales:{yAxes:[{ticks:{beginAtZero:!0}}]}}})}return $(\"article.\"+e+\"-card\").attr(\"xlabels\",n),$(\"article.\"+e+\"-card\").attr(\"ylabels\",t),i.push(f),f};function c(e,t,n){var a='</article>\\n\\n    <article class=\"card height-control '+(e=String(e))+\"-card graph-\"+e+'\" sensorType=\"'+t+'\" sensorId=\"'+e+'\">\\n    \\n        <div class=\"card-header\">\\n\\n            <h3 class=\"card-title\">\\n                <i class=\\'update-icon\\'></i>\\n                <span>'+n+\"</span> |\\n                <b>\"+e+'</b>\\n            </h3>\\n    \\n            <div class=\"card-tools\">\\n                <ul class=\"pagination pagination-sm\">\\n\\n                    <li class=\"page-item\">\\n                        <div id=\"reportrange\" style=\"background: #fff; cursor: pointer; padding: 5px 10px; border: 1px solid #ccc; width: 100%\">\\n                            <i class=\"fa fa-calendar\"></i>&nbsp;\\n                            <span></span> <i class=\"fa fa-caret-down\"></i>\\n                        </div>\\n                    </li>\\n\\n                    <li class=\"page-item\">\\n                        <div id=\"report\" class=\"tooltip_test\" style=\"background: #fff; cursor: pointer; padding: 5px 10px; border: 1px solid #ccc; width: 100%\">\\n                            <i class=\"fas fa-file-csv\"></i>\\n                            <span class=\"tooltiptext\">Download CSV</span>\\n                        </div>\\n                    </li>\\n\\n                </ul>\\n            </div>\\n    \\n        </div>\\n        \\n    \\n        <div class=\"card-body\">\\n            <a href=\"#\" class=\\'spinner '+e+\"-graph-spinner'>\\n                <span>Loading...</span>\\n            </a> \\n            <div class=\\\"\"+e+'-graph-calendar graph-calendar\">\\n                Time interval for '+e+' \\n                <input name=\"dates\" value=\"Button Change\"> \\n            </div> \\n        </div>\\n        \\n    </article>';return\"counter\"==t?'\\n    <article class=\"card height-control live-card-'+e+'\">\\n\\n    <div class=\"card-header\">\\n        <h3 class=\"card-title\">\\n            <i class=\\'update-icon\\'></i>\\n            Live Update\\n        </h3>\\n    </div>\\n\\n    <div class=\"card-body\">\\n        <div class=\"'+e+'-newItem\">\\n\\n            <a href=\"#\" class=\\'spinner '+e+\"-newItem-spinner'>\\n                <span>Loading...</span>\\n            </a>\\n\\n            <div id=\\\"\"+e+'-floatinBall\" class=\"hidden-element\"></div>\\n\\n        </div>\\n    </div>'+a:'\\n    <article class=\"card height-control live-card-'+e+'\" sensorId=\"'+e+'\">\\n\\n    <div class=\"card-header\">\\n        <h3 class=\"card-title\">\\n            <i class=\\'update-icon\\'></i>\\n            Current Value\\n        </h3>\\n        <span class=\\'card-settings-button hidden-button\\'>\\n            <i class=\"far fa-sliders-h\"></i>\\n        </span>\\n    </div>\\n\\n    <div class=\"card-body\">\\n        <div class=\"'+e+'-currentValue\">\\n            <a href=\"#\" class=\\'spinner '+e+\"-currentValue-spinner'>\\n                <span>Loading...</span>\\n            </a>\\n            <div id=\\\"\"+e+'-gauge\" class=\"gauge-container two hidden-element\">\\n                <span class=\"currentValue\"></span>\\n            </div>\\n        </div>\\n    </div>\\n\\n    <div class=\\'card-alerts-settings alert-'+e+'\\'>\\n        <span class=\\'card-settings-button-alert tooltip_test\\'>\\n            <i class=\"fas fa-bell\"></i>\\n            <span class=\"tooltiptext\">New feature is coming!</span>\\n        </span>\\n        <span class=\\'card-settings-button-update tooltip_test\\'>\\n            <i class=\"fas fa-save\"></i>\\n            <span class=\"tooltiptext\">By clicking you will update alerts and location!</span>\\n        </span>\\n        <span class=\\'card-settings-button-inner\\'>\\n            <i class=\"far fa-sliders-h\"></i>\\n        </span>\\n        <div class=\\'settings-wrapper\\'>\\n            <div class=\"slidecontainer\">\\n                <p class=\\'label-input\\'>Minimum</p>\\n                <input type=\"number\" placeholder=\"Type lower alert...\" class=\"input input-min\">\\n                <p class=\\'label-input\\'>Maximum</p>\\n                <input type=\"number\" placeholder=\"Type upper alert...\" class=\"input input-max\">\\n                <p class=\\'label-input\\'>Lat</p>\\n                <input type=\"number\" placeholder=\"Type lat value...\" class=\"input input-lat\">\\n                <p class=\\'label-input\\'>Long</p>\\n                <input type=\"number\" placeholder=\"Type long value...\" class=\"input input-long\">\\n            </div>\\n        </div>\\n    </div>\\n    '+a}let d=async()=>(await fetch(\"/api/read-alerts\")).json();function u(e){$(\".live-card-\"+e+\" .card-settings-button\").removeClass(\"hidden-button\"),$(\".live-card-\"+e+\"  .card-settings-button\").click((function(){$(this).parent().parent().children(\".card-alerts-settings\").toggleClass(\"alerts-settings-up\"),$(this).parent().parent().children(\".card-body\").toggleClass(\"blur8\"),$(this).parent().parent().children(\".card-header\").toggleClass(\"blur8\"),(async()=>{let e=await d();for(var t=0;t<e.result.length;t++){var n=e.result[t].sensorId;$(\".live-card-\"+n+\" .input-min\").attr(\"value\",e.result[t].min),$(\".live-card-\"+n+\" .input-max\").attr(\"value\",e.result[t].max)}var a=getLocationObj();for(var r in a)$(\"article[class*='live'][sensorid='\"+r+\"'] .input-lat\").attr(\"value\",a[r][0]),$(\"article[class*='live'][sensorid='\"+r+\"'] .input-long\").attr(\"value\",a[r][1])})()})),$(\".live-card-\"+e+\"  .card-settings-button-inner\").click((function(){$(this).parent().parent().children(\".card-alerts-settings\").toggleClass(\"alerts-settings-up\"),$(this).parent().parent().children(\".card-body\").toggleClass(\"blur8\"),$(this).parent().parent().children(\".card-header\").toggleClass(\"blur8\")})),$(\".live-card-\"+e+\" .card-settings-button-update\").click((function(){!async function(e){const t=$(\".live-card-\"+e+\" .settings-wrapper .input-min\").val(),n=$(\".live-card-\"+e+\" .settings-wrapper .input-max\").val(),a=$(\".live-card-\"+e+\" .settings-wrapper .input-lat\").val(),r=$(\".live-card-\"+e+\" .settings-wrapper .input-long\").val(),s=$(\"article[class*='graph-'][sensorid='\"+e+\"']\").attr(\"sensortype\");$(\"article[class*='live'][sensorid='\"+e+\"'] .gauge-container .minAlertGauge\").html(\"min: \"+t),$(\"article[class*='live'][sensorid='\"+e+\"'] .gauge-container .maxAlertGauge\").html(\"max: \"+n),await(async(e,t,n,a,r,s=null)=>{$.ajax({url:\"/api/set-alerts/?sensorId='\"+e+\"'&sensorType='\"+s+\"'&min=\"+t+\"&max=\"+n+\"&lat=\"+a+\"&long=\"+r,type:\"GET\",success:function(o){alert(\"Alerts and location updated!\"),console.log({msg:o,url:\"/api/set-alerts/?sensorId='\"+e+\"'&sensorType='\"+s+\"'&min=\"+t+\"&max=\"+n+\"&lat=\"+a+\"&long=\"+r})}})})(e,t,n,a,r,s)}(e)}))}function p(e,t){$(\".main-overlay\"),$(\".daterangepicker .cancelBtn\"),$(\".daterangepicker .applyBtn\"),$(\".ranges ul li:not(:last-child)\"),$(\"#main\");$(\".\"+e+\"-card #reportrange\").click((function(){}));var n=moment().format(\"HH\"),a=moment().format(\"mm\"),s=moment().subtract(n,\"hours\").subtract(a,\"minutes\"),o=moment();function i(t,n,a){t=t.format(\"YYYY-MM-DDTHH:mm\").split(\"+\")[0]+\":00.000000000Z\",n=n.format(\"YYYY-MM-DDTHH:mm\").split(\"+\")[0]+\":00.000000000Z\",startAux=new Date(t)-144e5,endAux=new Date(n)-144e5,t=moment(new Date(startAux)).format(\"YYYY-MM-DDTHH:mm\").split(\"+\")[0]+\":00.000000000Z\",n=moment(new Date(endAux)).format(\"YYYY-MM-DDTHH:mm\").split(\"+\")[0]+\":00.000000000Z\",b(t,n,r,e,a)}$(\".\"+e+\"-card #reportrange\").daterangepicker({timePicker:!0,timePicker24Hour:!0,startDate:moment().startOf(\"hour\").subtract(n,\"hour\"),endDate:moment().startOf(\"hour\").add(24-n,\"hour\")},i),i(s,o,t)}function f(e){switch(e){case\"temperatura\":var t=\"fas fa-temperature-high mr-1\";break;case\"temperature\":t=\"fas fa-temperature-high mr-1\";break;case\"counter\":t=\"far fa-chart-line\";break;case\"scale\":t=\"fas fa-balance-scale\";break;case\"voltage\":t=\"fas fa-car-battery\";break;default:t=\"fas fa-spinner\"}return t}async function h(e){let t=await d();for(var n=[],a=0,r=0;r<t.result.length;r++){$(\"body\");e.includes(t.result[r].sensorId)&&(n[a]=[t.result[r].sensorId,t.result[r].min,t.result[r].max,t.result[r].sensorType],a++)}var s=NaN,o=NaN;return n.forEach(t=>{e==t[0]&&(s=t[1],o=t[2],$(\"article[class*='live'][sensorid='\"+e+\"'] .gauge-container .minAlertGauge\").remove(),$(\"article[class*='live'][sensorid='\"+e+\"'] .gauge-container .maxAlertGauge\").remove(),$(\"article[class*='live'][sensorid='\"+e+\"'] .gauge-container\").prepend(\"<span class='minAlertGauge' value='\"+t[1]+\"' sensortype='\"+t[3]+\"'>min: \"+t[1]+\"</span><span class='maxAlertGauge' value='\"+t[2]+\"' sensortype='\"+t[3]+\"'>max: \"+t[2]+\"</span>\"),\"voltage\"==t[3]&&($(\"article[class*='live'][sensorid='\"+e+\"'] .gauge-container .currentValue\").addClass(\"alert-type-voltage\"),$(\"article[class*='live'][sensorid='\"+e+\"'] .gauge-container .minAlertGauge\").addClass(\"alert-type-voltage\"),$(\"article[class*='live'][sensorid='\"+e+\"'] .gauge-container .maxAlertGauge\").addClass(\"alert-type-voltage\")),\"temperature\"==t[3]&&($(\"article[class*='live'][sensorid='\"+e+\"'] .gauge-container .currentValue\").addClass(\"alert-type-temperature\"),$(\"article[class*='live'][sensorid='\"+e+\"'] .gauge-container .minAlertGauge\").addClass(\"alert-type-temperature\"),$(\"article[class*='live'][sensorid='\"+e+\"'] .gauge-container .maxAlertGauge\").addClass(\"alert-type-temperature\")))}),[s,o]}let m=async()=>(await fetch(\"/api/v2/get-data/sensorId/\"+r)).json(),g=async e=>(await fetch(\"/api/v2/get-data/\"+r+\"/\"+e)).json(),v=async e=>(await fetch(\"/api/experiment/get-data/\"+r+\"/\"+e)).json(),y=async e=>(await fetch(\"/api/get-data/last/\"+r+\"/\"+e)).json(),b=async(e,t,n,a,r)=>{\"object\"!=typeof r&&(async(e,t,n,a,r)=>{$(\"body\").hasClass(\"calendar-active\")||$(\"body\").addClass(\"calendar-active\");const s=new Date(n),o=new Date(a),i=Math.abs(o-s),c=Math.ceil(i/864e5),d=i/1e3/60/60;if(c<=1)if(d<=1)var u=\"1mins\";else if(d<=3)u=\"10mins\";else if(d<=6)u=\"10mins\";else u=\"10mins\";else if(c<=6)u=\"30mins\";else if(c<=45)u=\"daily\";else u=\"dailyS\";const p=\"/api/get-interval/\"+u+\"?county=\"+e+\"&sensorQuery=\"+t+\"&start=\"+n+\"&end=\"+a;$(\"#\"+t+\"-graph\").parent().parent().attr(\"calendar\",\"on\"),$(\"#\"+t+\"-graph\").parent().append('<a href=\"#\" class=\\'spinner '+t+\"-graph-spinner'><span>Loading...</span></a> \"),$(\"#\"+t+\"-graph\").remove(),fetch(p).then(e=>e.json()).then(e=>{const t=e[0].sensorQueried,n=t+\"-graph\";if(0==e[0].error){var a=\"\",r=0;try{for(;0==a.length;)null!=e[0].sensorAverage[r].sensorType&&(a=e[0].sensorAverage[r].sensorType),r++}catch{}const d=[],p=[];for(var s=0;s<e[0].sensorReadings;s++){d.push(parseFloat(e[0].sensorAverage[s].sensorValue).toFixed(2));var o=e[0].sensorAverage[s].sensorTime,i=new Date(o),c=i.setHours(i.getHours()-2);p.push(c),graphConfig=\"1mins\"==u?\"second\":\"10mins\"==u||\"30mins\"==u?\"minute\":\"hourly\"==u||\"hourlyS\"==u?\"hour\":\"day\"}const f=p.reverse(),h=d.reverse();$(\"#\"+n).removeClass(\"hidden-graph\"),$(\"#\"+n).parent().children(\".no-data-from-sensor\").remove(),!1,l(t,h,f,a,graphConfig),$(\"#\"+n).css(\"min-height\",\"250px\")}else $(\".\"+t+\"-graph-spinner\").remove(),$(\".\"+t+\"-card .card-body\").append(\"<p class='no-data-from-sensor' >No data for specified time range</p>\")}).catch((function(e){console.log(e),e=\"this is an error\",console.log(e)}))})(n,a,e,t)};var w=[],k=[];(async()=>{s=await m()})().then(()=>{if(s[0].error);else{const t=s[0],n=t.sensorIdListLength;t.sensorIdList;for(var e=0;e<n;e++)(async()=>{var n=t.sensorIdList[e],a=t.sensorZoneList[e],r=t.sensorTypeList[e];let s=await g(n);s[0].error&&(s[0].sensorType=r,s[0].sensorZone=a),$(\".card-container\").append(c(s[0].sensorQueried,s[0].sensorType,s[0].sensorZone)),u(s[0].sensorQueried),$(\".live-card-\"+s[0].sensorQueried+\" .update-icon\").addClass(f(s[0].sensorType)),$(\".graph-\"+s[0].sensorQueried+\" .update-icon\").addClass(f(s[0].sensorType));for(var i=[],d=[],m=s[0].sensorType,v=0;v<s[0].sensorReadings;v++){i.push(parseFloat(s[0].sensorAverage[v].sensorValue).toFixed(1));var b=s[0].sensorAverage[v].sensorTime,C=new Date(b),A=C.setHours(C.getHours()-2);d.push(A)}const j=d.reverse(),T=i.reverse();new Promise((function(e,t){})),await y(n).then(e=>{h(s[0].sensorQueried).then(t=>{w.push([n,o(n,e[0].lastValue.value,e[0].lastValue.time,min=t[0],max=t[1])])})});k.push([n,l(String(n),T,j,m)]),p(n,k);$(\"article.graph-\"+s[0].sensorQueried+\" #report\").click((function(e){var t=$(this).parent().parent().parent().parent().parent();x({filename:\"Report.csv\",xlabels:t.attr(\"xlabels\"),ylabels:t.attr(\"ylabels\")})}))})();!function(e,t,n=!1){var a='<div class=\"small-box bg-info county-detail box-shadow-5\">\\n        <div class=\"inner\">\\n            <h3>'+t+\"</h3>\\n            <p>\"+e+\"</p>\\n        </div>\";n&&(a+='<div class=\"icon\"><i class=\"'+n+'\"></i></div>'),a+=\"</div>\",$(\".small-box-container\").append(a)}(\"Sensors\",t.sensorIdListLength,fontAwesome=\"fa fa-check\")}var t;return t=$(\".small-box-container .small-box\").length,$(\".small-box-container\").addClass(\"small-box-length-\"+t),k});function x(e){for(var t,n,a,r=\"\",s=e.ylabels.split(\",\"),o=e.xlabels.split(\",\"),i=0;i<s.length;i++){var l=new Date(parseInt(o[i]));l=l.toLocaleString(\"en-US\",{timeZone:\"Europe/Bucharest\",timeStyle:\"medium\",dateStyle:\"long\"}).split(\" \").join(\"_\").split(\",\").join(\"\"),console.log(l),r+=l+\",\"+s[i].toString()+\"\\n\"}null!=r&&(n=e.filename||\"chart-data.csv\",r.match(/^data:text\\/csv/i)||(r=\"data:text/csv;charset=utf-8,\"+r),t=encodeURI(r),(a=document.createElement(\"a\")).setAttribute(\"href\",t),a.setAttribute(\"download\",n),document.body.appendChild(a),a.click(),document.body.removeChild(a))}function C(e,t){return JSON.stringify(e)==JSON.stringify(t)}function A(e,t,n){var a=e.data.datasets[0].data.slice(0,e.data.datasets[0].data.length);a.length>0&&n.length>0?0==C(n,a)&&(e.data.datasets[0].data=n,e.data.labels=t,e.update()):0==a.length&&0==C(n,a)&&(e.data.datasets[0].data=n,e.data.labels=t,e.update())}function j(e){(async()=>{let t=await m();if(t[0].error);else{const a=t[0],r=a.sensorIdListLength;for(var n=0;n<r;n++)(async()=>{var t=a.sensorIdList[n];let r=await g(t);for(var s=[],o=[],i=0;i<r[0].sensorReadings;i++){s.push(parseFloat(r[0].sensorAverage[i].sensorValue).toFixed(2));var l=r[0].sensorAverage[i].sensorTime,c=new Date(l),d=c.setHours(c.getHours()-2);o.push(d)}const u=o.reverse(),p=s.reverse();let f=0;e.forEach(e=>{if(null!=e){var n=e.canvas.id.split(\"-graph\")[0];\"on\"==$(\"#\"+n+\"-graph\").parent().parent().attr(\"calendar\")||(n==t?A(e,u,p):n!=t||isNaN(p[p.length-1])||f++)}}),f&&location.reload()})()}})()}async function T(e){return await new Promise(t=>setTimeout(t,e))}(async()=>{for(;;)j(i),await T(5e3)})();socket.on(\"socketChannel\",async e=>{var t=new Date;w.forEach(n=>{if(e.topic.includes(n[0])){t=t.toLocaleString(\"en-US\",{timeZone:\"Europe/Bucharest\",timeStyle:\"medium\",dateStyle:\"long\"}),function(e,t,n,a=!1){$(\"#\"+e+\"-gauge .currentValue\").removeAttr(\"no-value\");var r=!1;if(r=\"c\"==e.split(\"-\")[1],!isNaN(n)&&!r)try{t.setValue(n)}catch{t.html(n)}if(n==parseInt(n,10)?e.includes(\"source\")?$(\"#\"+e+\"-gauge g.text-container text\").append(\".0 V\"):$(\"#\"+e+\"-gauge g.text-container text\").append(\".0 &#8451;\"):e.includes(\"source\")?$(\"#\"+e+\"-gauge g.text-container text\").append(\" V\"):$(\"#\"+e+\"-gauge g.text-container text\").append(\" &#8451;\"),a){new Date;if(updatedTime=a,r)$(\".\"+e+\"-newItem .update-time-gauge\").html().split(\"Updated at \")[1]!=updatedTime&&($(\".\"+e+\"-newItem .update-time-gauge\").html(\"Updated at \"+updatedTime),$(\"#\"+e+\"-floatinBall\").addClass(\"pulse-effect\"),timeout(4500,(function(){$(\"#\"+e+\"-floatinBall\").removeClass(\"pulse-effect\")})));else $(\".\"+e+\"-currentValue .update-time-gauge\").html(\"Updated at \"+updatedTime)}}(n[0],n[1],parseFloat(e.message).toFixed(1),updatedAt=t);var a=n[1][0].parentElement.id.split(\"-\")[0];$(\"article[sensorId='\"+a+\"']\").attr(\"topic\",e.topic)}})})},168:function(e,t){var n;let a=[];if(\"undefined\"!=typeof sensorId){var r=[];(async()=>{json=await(async()=>(await fetch(\"/api/read-location\")).json())()})().then(()=>(json.result.forEach(e=>{sensorId.includes(e.sensorId)&&(numbers=e.coord.split(\",\").map(Number),numbers.push(e.sensorId),r.push(numbers))}),r)).then(async e=>{var t=\"\",n=0;if(e.forEach(async a=>{++n!=e.length?t+=a[2]+\",\":t+=a[2]}),t.length){return(await(async e=>(await fetch(\"/api/get-last-value/?sensorIdList=\"+e)).json())(t)).forEach(e=>{a.push([e.sensorQueried,e.value])}),await([e,a])}return await([e,[NaN,NaN]])}).then(e=>{if(e[0])var t=e[0];else t=[];if(u(t,e[1]),n=t,$(\"#map\")){var a=0;n.forEach(e=>{var t=[e[1],e[0]],r=new ol.geom.Point(ol.proj.fromLonLat(t));n[a]=[r.flatCoordinates,e[2]],a++})}})}$(\"body\").attr(\"location\",\"\");var s={};function o(e,t){var n=$(\"body\");s[e]=t;var a=JSON.stringify(s);n.attr(\"location\",a)}function i(e){return e*(Math.PI/180)}function l(){var e,t,n,a,r,s,o,l=d(),c=[];for(item in l)c.push(l[item]);if(2==c.length)var u=(e=c[0][1],t=c[0][0],n=c[1][1],a=c[1][0],r=i(n-e),s=i(a-t),o=Math.sin(r/2)*Math.sin(r/2)+Math.cos(i(e))*Math.cos(i(n))*Math.sin(s/2)*Math.sin(s/2),2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o))*6371*1e3);else if(1==c.length)u=2e3;else if(c.length>=3)u=2e3;return console.log(\"getZoomOfMap:\",c.length,u),u<1500?17:6}function c(){var e=d(),t=0,n=0,a=0;for(var r in e)t+=e[r][0],n+=e[r][1],a++;return t/=a,n/=a,console.log(\"center of map\",n,t),[n,t]}function d(){var e=$(\"body\"),t=[];return e.attr(\"location\")?(t.push(e.attr(\"location\")),JSON.parse(t)):{bucharest:[44.439663,26.096306]}}function u(e,t){for(var a=new Array,r=0;r<e.length;++r){o(e[r][2],[e[r][0],e[r][1]]);var s=new ol.Feature(new ol.geom.Point(ol.proj.fromLonLat([e[r][1],e[r][0]])));a.push(s)}var i,d=new ol.source.Vector({features:a,test:\"string\"}),u=new ol.source.Cluster({distance:75,source:d}),p={};function f(e){var a=void 0;return n.forEach(n=>{!0===n[0].equals(e)&&t.forEach(e=>{n[1]==e[0]&&(a=n[1].includes(\"source\")?parseFloat(e[1])+\"V\":parseFloat(e[1])+\"Â°C\")})}),null==a?\"undefined\":a}clusters=new ol.layer.Vector({source:u,style:function(e){var t,n=e.get(\"features\").length;return i=e.getGeometry().flatCoordinates,!t&&n>1?(t=new ol.style.Style({image:new ol.style.Circle({radius:20,fill:new ol.style.Fill({color:\"#ffc107\"})}),text:new ol.style.Text({scale:2.8,text:n.toString(),fill:new ol.style.Fill({color:\"black\"})})}),p[n]=t,t):!t&&n<=1?(t=new ol.style.Style({image:new ol.style.Icon({anchor:[.5,.5],anchorXUnits:\"fraction\",anchorYUnits:\"fraction\",src:\"/images/ol_logo.png\",scale:.05,radius:10}),text:new ol.style.Text({padding:[1,0,0,4],text:f(i).toString(),placement:\"point\",scale:2,textAlign:\"center\",textBaseline:\"middle\",offsetX:2,offsetY:-40,backgroundFill:new ol.style.Fill({color:\"black\"}),fill:new ol.style.Fill({color:\"white\"})})}),p[n]=t,t):void 0}});var h=new ol.layer.Tile({source:new ol.source.OSM});map=new ol.Map({layers:[h,clusters],target:\"map\",view:new ol.View({center:ol.proj.fromLonLat(c()),zoom:l()})})}Array.prototype.equals&&console.warn(\"Overriding existing Array.prototype.equals. Possible causes: New API defines the method, there's a framework conflict or you've got double inclusions in your code.\"),Array.prototype.equals=function(e){if(!e)return!1;if(this.length!=e.length)return!1;for(var t=0,n=this.length;t<n;t++)if(this[t]instanceof Array&&e[t]instanceof Array){if(!this[t].equals(e[t]))return!1}else if(this[t]!=e[t])return!1;return!0},Object.defineProperty(Array.prototype,\"equals\",{enumerable:!1})}});","extractedComments":[]}